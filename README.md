<p align="center">
  <img src="./assets/hero-heb.png" width="100%" />
</p>

<div dir="rtl" align="right">

# DictaLM 3.0
# BricksLLM  צ'אט בינה מלאכותית ישראלי על תשתית
**גירסה 1.0.0**

**שלום חברים!** 👋
פרויקט זה נועד להפוך את השימוש במנוע הבינה המלאכותית הישראלית הכי מתקדם, **DictaLM-3.0**, לפשוט חינמי ונגיש לכולם.
השתדלתי לבנות עבורכם מערכת "הכל-כלול" המאפשרת להריץ את המודל המדהים והפתוח מבית דיקטא אצלכם במחשב, בפרטיות מלאה, ועם ממשק צ'אט נוח ומוכן לשימוש.

חיברתי אליו עשרות תכונות ופונקציות מתקדמות באופן שתקבלו חיבוריות לאינספור מקורות מידע מהרשת וסביבת העבודה בה המערכת מותקנת

---

## 🌟 למה להשתמש בזה?

* 🧠 קודם כל השתדלתי לפתור בעיה בתבנית השיחה של המודל שבכל יתר הפלטפורמות גורם למודל לספק תשובות בלתי נגמרות
*   🛡️ **פרטיות מוחלטת**: הכל רץ על המחשב שלכם. שום מילה לא יוצאת לענן או לשרתים חיצוניים.
*   💬 **ממשק צ'אט מוכן**: כולל מסך שיחה (כמו ChatGPT) שתומך בעברית ומציג את "תהליך החשיבה" של המודל.
*   🚀 **התקנה קלה**: במקום להסתבך עם עשרות הגדרות, פקודה אחת מריצה את הכל.
*   🚀 **התממשקות מהירה למודל**: בניתי את ממשק התקשורת עם המודל על בסיס שפת go lang
*   🧠 **ניהול חכם**: המערכת דואגת לכל "האינסטלציה" הטכנית מאחורי הקלעים באופן אוטומטי, וכוללת יכולות להגדיר תכונות מתקדמות. לא חובה לשנות כלום. רק אם רוצים:
    *   ⏳ **מגבלות שימוש**: הגדרת מכסות שימוש (Rate Limits) למשתמשים שונים לפי רמות תמחור.
    *   📊 **מעקב ובקרה**: ניטור צריכת משאבים ברמת משתמש או ארגון.
    *   🛡️ **אבטחת מידע**: חסימה או צנזור אוטומטי של מידע רגיש (PII) בבקשות.
    *   🔄 **אמינות**: מנגנוני גיבוי (Failover), ניסיונות חוזרים (Retries) ומטמון (Caching) לשיפור היציבות.
    *   🔑 **ניהול מפתחות**: הפצת מפתחות API עם מגבלות קצב ועלות למפתחים, סביבות ייצור, או סטודנטים.

---

## 🌟 ממשק משתמש נוח פשוט ורב תכליתי
הממשק זמין בכתובת **localhost:8004** 
ותומך ב:

* - **היסטוריית שיחות**
* - **כותרות אוטומטיות לשיחה**
* - **תמיכה בהצגת תהליך החשיבה בכל פניה למודל**
* - **הדגשת תחביר (Syntax highlighting - Atom one dark)**
* - **תמיכה מלאה ב-Markdown**
* - **רינדור מתמטי (KaTeX)**
* - **טבלאות Markdown**
* - **דיאגרמות Mermaid**
* - **תמיכה מלאה ואוטומטית בעברית ואנגלית (יישור אוטומטי לימין ולשמאל)**
* - **שרתי MCP מוגדרים ומוכנים מראש**
* - **תמיכה בהוספה ניתוק וחיבור שרתי MCP חדשים**
* - **תמיכה בהעלאה של קבצים לשיחה**
* - **תמיכה בהורדה של קטעי קוד מהשיחה**
* - **גישת API מלאה למודל DictaLM**
* - **הגדרה פשוטה של פרומפט המערכת מקובץ .env**
* - **תמיכה בהעלאה של קבצים לשיחה**
* - **ערכת נושא כהה ובהירה לפי בחירה**
* - **חיפוש ברשת באמצעות מנוע Tavily**
* - **ביצוע מחקרי עומק באמצעות מנוע Perplexity**
* - **קבלת תקציר וניתוח סרטוני יוטיוב**
* - **מערכת מתקדמת לניהול זכרון מתמשך לאורך שיחה ובין שיחות**
* - **חיפוש במאגרי המידע הממשלתיים של ישראל (data.gov.il)**
* - **בחירה אוטומטית של הכלי הטוב ביותר לכל שאילתה**
* - **מנגנון fallback חכם - אם כלי אחד נכשל, המערכת מנסה אחרים**
* - **הודעות שגיאה ידידותיות בעברית עם הסבר מה לעשות**
* - **המודל יודע לספר לכם אילו כלים יש לו ומתי להשתמש בהם**
* - **ועוד עשרות רבות של תכונות .....ועוד היד נטויה**

---

<img src="./assets/dicta_frontend_intro.gif" width="100%" height="100%"/>

---

## 🧠 מערכת הכלים החכמה - Enterprise Tool Intelligence

בניתי מערכת מתקדמת שגורמת למודל להיות הרבה יותר חכם בשימוש בכלים. במקום שהמודל יתבלבל או יכשל, המערכת דואגת לכל הלוגיסטיקה מאחורי הקלעים:

### מה המערכת יודעת לעשות?

* 🎯 **בחירה חכמה של כלים**: כששואלים שאלה בעברית, המערכת מזהה את הכוונה ובוחרת את הכלי המתאים ביותר. למשל, אם שואלים על נתונים ממשלתיים - היא תפנה קודם למאגר data.gov.il

* 🔄 **מנגנון Fallback אוטומטי**: אם כלי אחד נכשל או לא מחזיר תוצאות, המערכת מנסה אוטומטית כלים חלופיים לפי סדר עדיפויות. המשתמש לא רואה את זה - פשוט מקבל תשובה

* 📝 **תיקון פרמטרים אוטומטי**: המודל לפעמים שולח פרמטרים לא נכונים לכלים. המערכת מתקנת את זה אוטומטית - למשל, אם המודל שלח `query` במקום `messages`, המערכת יודעת להמיר

* ⏱️ **ניהול זמנים חכם**: כלי מחקר מעמיק מקבל 5 דקות, חיפוש מהיר מקבל דקה. ככה לא נתקעים על timeouts מיותרים

* 💬 **הודעות שגיאה בעברית**: במקום שגיאות טכניות מפחידות, המשתמש מקבל הסבר ברור מה קרה ומה אפשר לעשות

* 🤖 **המודל מכיר את היכולות שלו**: אם תשאלו "מה אתה יכול לעשות?" או "אילו כלים יש לך?", המודל ידע לענות ואפילו יציע כלים רלוונטיים תוך כדי השיחה

### הכלים שעומדים לרשות המודל (MCP Servers)

חיברתי למערכת 12 שרתי MCP שמעניקים למודל יכולות מגוונות:

| כלי | מה הוא עושה |
| :--- | :--- |
| 🔍 **Tavily** | חיפוש חכם ברשת - מוצא מידע עדכני מכל האינטרנט |
| 🧠 **Perplexity** | מחקר מעמיק עם 4 מצבים: research, ask, search, reason |
| 🏛️ **DataGov** | גישה ישירה ל-1,190 מאגרי מידע ממשלתיים |
| 📁 **Filesystem** | קריאה וכתיבה של קבצים בתיקיית Sandbox |
| 🐙 **Git** | פקודות Git - clone, commit, push, status ועוד |
| 🐳 **Docker** | ניהול קונטיינרים - הרצה, עצירה, רשימת images |
| 🌐 **Fetch** | הורדת תוכן מכתובות URL |
| 🎬 **YouTube** | סיכום וניתוח של סרטוני יוטיוב |
| 🧠 **Memory** | זכרון מתמשך בין שיחות |
| 🕐 **Time** | שעון ותאריך (מותאם לאזור הזמן של ישראל) |
| 🤔 **Sequential Thinking** | חשיבה צעד-אחר-צעד לבעיות מורכבות |
| 🔧 **Everything** | כלי עזר כלליים נוספים |

### סטטיסטיקות מרשימות

| מה יש לנו | כמה |
| :--- | :--- |
| שרתי MCP פעילים | 12 |
| שיטות חכמות | 30+ |
| מונחים לזיהוי כוונה (עברית ↔ אנגלית) | ~9,500 |
| קטגוריות כלים | 6 (מחקר, חיפוש, נתונים, קבצים, פיתוח, כללי) |
| שרשראות Fallback | 3 (מידע ממשלתי, מחקר מעמיק, חיפוש מהיר) |

---

## 🏛️ חיבור למאגרי המידע הממשלתיים (DataGov)

הוספתי חיבור מלא למאגרי הנתונים הפתוחים של ממשלת ישראל. עכשיו אפשר לשאול שאלות כמו:
- "כמה רכבים חשמליים יש בישראל?"
- "תן לי רשימת בתי חולים עם מספרי טלפון"
- "מה התקציב של משרד החינוך?"

### מה מיוחד בחיבור הזה?

* 📊 **1,190 מאגרי נתונים מוכנים מראש** - כל מאגר עם מטא-דאטה מפורט על השדות שלו

* 🔍 **הבנת עברית מתקדמת**: המערכת מבינה שינויים מורפולוגיים - "ברכבים", "לרכבים", "רכבים" - הכל מתורגם נכון

* 📍 **הפרדה בין מה לאיפה**: כששואלים "בתי חולים בירושלים", המערכת מבינה ש"בתי חולים" זה הנושא ו"ירושלים" זה המיקום

* 🔢 **חישוב סיכומים אוטומטי**: שאלות "כמה" מקבלות תשובה מספרית ישירה, לא רשימה ארוכה של שורות

* 🌐 **22 תחומים עם תרגום דו-כיווני**: משפטים, בריאות, חינוך, תחבורה, תקציב ועוד - המערכת מכירה מונחים בעברית ובאנגלית

### התחומים הזמינים (21 קטגוריות)

| תחום | דוגמאות למאגרים |
| :--- | :--- |
| 🏥 **בריאות** | בתי חולים, מרפאות, קופות חולים, טיפות חלב, מעבדות רפואיות |
| 🚗 **תחבורה** | רכבים חשמליים, נתיבי HOV, תאונות דרכים, רישיונות נהיגה |
| 💰 **כספים** | תקציב המדינה, חברות ציבוריות, מכרזים ממשלתיים |
| 🎓 **חינוך** | בתי ספר, אוניברסיטאות, מוסדות להשכלה גבוהה |
| ⚖️ **משפט** | בתי משפט, בקשות לפטנטים, בתי דין דרוזיים ושרעיים |
| 🌍 **סביבה** | איכות אוויר, מפגעים סביבתיים, שמורות טבע |
| 🏠 **דיור** | דירות להשכרה, מחירי נדל"ן, תכניות בנייה |
| 👥 **דמוגרפיה** | נתוני אוכלוסייה, לידות, תמותה, הגירה |
| 🏛️ **רשויות מקומיות** | עיריות, מועצות, שירותים מוניציפליים |
| 💼 **רווחה** | קצבאות, שירותי רווחה, סיוע לקשישים |
| 🌊 **מים** | מאגרי מים, איכות מים, צריכת מים |
| 🗺️ **גיאוגרפיה** | גבולות, אזורים, ערים, ישובים |
| 📡 **תקשורת** | ספקי אינטרנט, תדרים, רישיונות שידור |
| 🏛️ **דת** | בתי כנסת, בתי עלמין, מועצות דתיות |
| ✈️ **תיירות** | מלונות, אתרי תיירות, כניסות לישראל |
| 🌾 **חקלאות** | גידולים, משקים, יצוא חקלאי |
| 🔬 **טכנולוגיה** | סטארטאפים, מו"פ, פטנטים |
| 💼 **כלכלה** | תעסוקה, יצוא, יבוא, תוצר לאומי |
| 🛂 **הגירה** | עלייה, ויזות, אזרחות |
| 🎭 **תרבות** | מוזיאונים, ספריות, אירועי תרבות |
| 📊 **כללי** | סטטיסטיקות לאומיות, סקרים, מדדים |

---

##  מה צריך כדי להתחיל? (דרישות מערכת)

כדי שהמערכת תעבוד חלק, המחשב שלכם צריך להיות חזק מספיק:

1.  **כרטיס מסך (GPU)**: חובה כרטיס של חברת **NVIDIA**.
    *   *מומלץ*: 16GB זיכרון וידאו (VRAM) ומעלה (כדי שהמודל ירוץ מהר).
    *   *נבדק ועובד נהדר על*: Nvidia RTX 3900 24GB.
        *   *מהירות צפויה*: ~35 מילים לשנייה. 
        *   *טוקנים לשניה*: ~50 טוקנים לשנייה. 

2.  **תוכנת Docker**: התוכנה שמריצה את המערכת. ודאו שהיא מותקנת ופועלת.
3.  **מקום פנוי**: כ-20GB פנויים בדיסק מהיר (SSD/NVMe).
4.  **CUDA Toolkit**: תוודאו שמותקן אצלכם מראש
5.  **נבדק ועובד נהדר על**: Windows 11 with WSL2 and Ubuntu 22.04 LTS
    עם 64 גיגה זכרון

---

## 🏁 מדריך התקנה מהיר (4 שלבים וסיימנו)

### שלב 1: הורדת הפרויקט והגדרת סביבה 🛠️

לפני שנוריד את המודל, עלינו להוריד את קבצי הפרויקט למחשב ולהגדיר את הסביבה.

1.  **הורדת הפרויקט (Clone)**:
    פתחו את הטרמינל (שורת הפקודה) והעתיקו את הפקודה הבאה:
    ```bash
    git clone https://github.com/oznav2/DictaChat.git
    cd BricksLLM
    ```

2.  **הגדרת קובץ הסביבה (.env)**:
    המערכת צריכה קובץ הגדרות מיוחד כדי לדעת סיסמאות לשרתי פונקציות ומיקומי קבצים חשובים. הכנו עבורכם תבנית מוכנה בעברית.
    
    הריצו את הפקודה הבאה כדי ליצור את הקובץ:
    ```bash
    cp .env.heb .env
    ```

    **חשוב מאוד!** ⚠️
    עליכם לפתוח את הקובץ `.env` שנוצר ולשנות בו את הסיסמאות והמפתחות.
    חפשו שורות המכילות `your_..._here` והחליפו אותן בסיסמאות אמיתיות משלכם.
    
    לדוגמה, שנו את:
    `POSTGRESQL_PASSWORD=your_secure_postgres_password_here`
    למשהו כמו:
    `POSTGRESQL_PASSWORD=MySecretPassword123`

### שלב 2: הורדת "המוח" (המודל) 🧠
לפני הכל, אנחנו צריכים להוריד את קובץ המודל (ה"מוח" של הבינה המלאכותית). זהו קובץ גדול (כ-13GB).

סקריפט ההרצה `start.sh` מכיל את הפקודות הנדרשות להורדת המודל .
אבל מומלץ לבצע זאת ידנית בכל זאת לפני הרצה ראשונה בכדי להמנע משגיאות

פתחו את הטרמינל בתיקיית הפרויקט והריצו:

```bash
# יצירת תיקייה למודלים
mkdir -p ./models

# הורדת המודל (שימו לב: זה יקח זמן בהתאם למהירות האינטרנט)
wget https://huggingface.co/VRDate/DictaLM-3.0-24B-Thinking-FP8-Q4_0-GGUF/resolve/main/dictalm-3.0-24b-thinking-fp8-q4_0.gguf -O ./models/dictalm-3.0-24b-thinking-fp8-q4_0.gguf
```
*(אם אין לכם `wget`, ניתן להוריד את הקובץ ידנית מהקישור ולהניח אותו בתיקיית `models` בשם המופיע בפקודה).*

### שלב 3: הפעלת המערכת 🚀
ובמקרה...הכינותי מראש.. סקריפט חכם שעושה את כל העבודה. הריצו בטרמינל:

```bash
./start.sh
```
הסקריפט יבדוק שהכל תקין, יפעיל את המנועים, ויגיד לכם מתי הכל מוכן (חפשו את המילה **HEALTHY**).
*הערה: בהפעלה הראשונה זה עשוי לקחת כדקה עד שהמודל נטען לזיכרון.*

### שלב 4: מתחילים לדבר! 💬
פתחו את הדפדפן שלכם בכתובת:
👉 **http://localhost:8004**

הממשק החדש זמין בכתובת **localhost:8004** ותומך ב:

זהו! עכשיו גם אתם יכולים להתחיל לשוחח עם דיקטא גם באנגלית וגם בעברית.
באיכות ממשק של מודלים בתשלום, בפרטיות של הסביבה הפרטית של המחשב שלכם ובחינם

---

## ⚠️ חוק ברזל: כיבוי והדלקה

כדי לשמור על המערכת בריאה ולמנוע תקלות, **חובה** לבצע כיבוי מסודר לפני שמפעילים מחדש.

**הנוסחה המנצחת:**
בכל פעם שאתם רוצים להפעיל מחדש או לעדכן משהו:

1.  🛑 **קודם כל עוצרים:**
    ```bash
    ./stop.sh
    ```
2.  🟢 **רק אז מפעילים:**
    ```bash
    ./start.sh
    ```

*למה?* זה מבטיח שכל הפורטים משתחררים ושההגדרות החדשות נטענות כמו שצריך.

---

## 🔧 למתקדמים: מה קורה מתחת למכסה המנוע?

עבור מי שרוצה לדעת קצת יותר, המערכת מורכבת מכמה רכיבים שעובדים יחד בתיאום מושלם:

| הרכיב | פורט | תפקיד |
| :--- | :--- | :--- |
| **New Frontend** | `8004` | **ממשק המשתמש**: כולל תמיכה בהיסטוריה, העלאת קבצים ועוד. |
| **BricksLLM SwagerUI Gateway** | `8002` | **המנהל**: שער חכם שמנתב את הבקשות, שומר על אבטחה ומנהל את העומס. |
| **Llama Server** | `5002` | **המנוע**: התוכנה שמריצה את המודל עצמו על כרטיס המסך. |
| **Admin API** | `8001` | **ניהול**: ממשק לשינוי הגדרות מתקדמות ומפתחות API. |
| **Postgres & Redis** | - | **זיכרון**: מסדי נתונים לשמירת הגדרות וזיכרון מטמון (Cache) לביצועים מהירים. |
| **MCP Servers** | `3100` | **sse stdio streamable**: כולל תמיכה ב80 כלים ועוד. |

### רוצים להתחבר דרך קוד? (API)
אם אתם מפתחים ורוצים להשתמש במודל דרך הקוד שלכם, השתמשו בפרטים הבאים:
*   **כתובת**: `http://localhost:8002/api/custom/providers/llama-cpp-root/chat/completions`
*   **מפתח (API Key)**: `sk-bricksllm-frontend-llama-key-explicit`
*   **פורמט**: תואם OpenAI (רגיל).

---

# ℹ️ בהערכה

זוהי מבחינתי גירסה ראשונית של המערכת ובוודאי שהיא לא חפה מבאגים ולגמרי ניתן לשפר אותה ולהשלים בה את הפונקציונליות 
.ככל שיותיר לי הזמן אשתדל לעדכנה מעת לעת. אתם מוזמנים לדווח על תקלות והצעותיכם לשיפור והרחבה. 
בהצלחה! 

אילן אלחיאני,  
תמיכה בפרויקט, דירוגו בגיטהב וכמובן שהשתתפות שלכם בהפצתו וקידומו יתקבלו בברכה! 🙏

---

## תודות וקרדיטים:

<p align="center">
  <a href="https://discord.gg/dFvdt4wqWh"><img src="https://img.shields.io/badge/discord-BricksLLM-blue?logo=discord&labelColor=2EB67D" alt="Join BricksLLM on Discord"></a>
  <a href="https://github.com/bricks-cloud/bricks/blob/main/LICENSE"><img src="https://img.shields.io/badge/license-MIT-red" alt="MIT License"></a>
  <a href="https://github.com/huggingface/chat-ui/blob/main/LICENSE"><img src="https://img.shields.io/badge/License-Apache_2.0-blue.svg" alt="Apache-2.0-License"></a>
</p>

</div>
